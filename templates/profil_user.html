{% extends "base.html" %}

{% block title %}Profil User{% endblock %}

{% block custom_css %}
<style>
    body {
        background-color: #fff;
    }

    .profile-container {
        padding: 2rem 6rem;
        background-color: #fff;
    }

    .header-profil {
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-left: 5px solid #ff9800;
        padding-left: 12px;
        margin-bottom: 2rem;
    }

    .header-profil h2 {
        font-size: 2rem;
        font-weight: 700;
        color: #000;
        margin: 0;
    }

    .edit-icon {
        font-size: 26px;
        color: #ff9800;
        cursor: pointer;
        transition: 0.2s;
    }

    .edit-icon:hover {
        color: #e68900;
    }

    .user-info-section {
        text-align: center;
        margin-bottom: 3rem;
    }

    .profile-avatar {
        width: 160px;
        height: 160px;
        border-radius: 8px;
        object-fit: cover;
        margin: 0 auto 1rem;
        background-image: url('{{ customer.foto_url or "https://static.promediateknologi.id/crop/0x0:0x0/0x0/webp/photo/p2/222/2024/01/08/11704492-0457-4be8-9256-20411d646e40-1-307500539.jpg" }}');
        background-size: cover;
        background-position: center;
        border: 4px solid #ff9800;
    }

    .user-name {
        font-size: 1.6rem;
        font-weight: 600;
        color: #000;
        margin-bottom: 5px;
    }

    .user-role {
        font-size: 1.1rem;
        color: #ff9800;
    }

    .info-section {
        background: none;
        border-radius: 0;
        padding: 0;
    }

    .info-header {
        font-size: 1.2rem; 
        font-weight: 600;
        color: #000;
        margin-bottom: 1.5rem;
    }

    .info-item {
        margin-bottom: 1.5rem;
        border: 2px solid #ccc;
        border-radius: 10px;
        padding: 12px 16px;
        background-color: #f5f5f5;
    }

    .info-label {
        display: flex;
        align-items: center;
        font-size: 1rem; 
        font-weight: 600;
        color: #000;
        margin-bottom: 5px;
    }

    .info-label i {
        margin-right: 10px;
        font-size: 1.2rem;
        color: #ff9800;
    }

    .info-value {
        color: #000;
        font-size: 0.95rem; 
        font-weight: 500;
    }

    .btn-logout {
        display: block;
        width: 100%;
        background-color: #ff9800;
        border: none;
        padding: 14px;
        border-radius: 10px;
        color: white;
        font-weight: 600;
        margin-top: 40px;
        cursor: pointer;
        font-size: 1.1rem;
        text-decoration: none;
        transition: 0.2s;
    }

    .btn-logout:hover {
        background-color: #e68900;
    }

    a {
        text-decoration: none;
    }

    .modal-content {
        border-radius: 12px;
        padding: 30px;
        max-width: 650px; 
        margin: auto;
    }

    .profile-title {
        font-size: 1.4rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 20px;
        text-align: center;
    }

    .btn-save {
        background-color: #ff9800;
        color: white;
        font-weight: 600;
        padding: 10px 22px;
        border-radius: 8px;
        border: none;
        font-size: 1rem;
    }

    .btn-save:hover {
        background-color: #e68900;
    }

    .profile-img {
        width: 140px; 
        height: 140px;
        border-radius: 8px;
        object-fit: cover;
        border: 3px solid #ff9800;
        margin-bottom: 15px;
    }

    .modal-close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: transparent;
        border: none;
        font-size: 1.5rem;
        color: #999;
        cursor: pointer;
    }

    .modal-close-btn:hover {
        color: #333;
    }

    @media (max-width: 768px) {
        .profile-container {
            padding: 1.5rem 2rem;
        }

        .modal-content {
            width: 90%;
            padding: 20px;
        }

        .profile-avatar {
            width: 130px;
            height: 130px;
        }

        .profile-img {
            width: 120px;
            height: 120px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="profile-container">

    <div class="header-profil">
        <h2>Profil</h2>
        <a href="#" class="edit-icon" data-bs-toggle="modal" data-bs-target="#editProfileModal">
            <i class="bi bi-pencil-square"></i>
        </a>
    </div>

    <div class="user-info-section">
        <div class="profile-avatar"></div>
        <h4 class="user-name">{{ customer.nama or "Ahmad Imam" }}</h4>
        <p class="user-role">Customer</p>
    </div>

    <div class="info-section">
        <p class="info-header">Informasi Akun</p>

        <div class="info-item">
            <div class="info-label"><i class="bi bi-telephone"></i>Nomor Telepon</div>
            <p class="info-value">{{ customer.telepon or "+62 890-9875-1457" }}</p>
        </div>

        <div class="info-item">
            <div class="info-label"><i class="bi bi-envelope"></i>Email</div>
            <p class="info-value">{{ customer.email or "imamg@gmail.com" }}</p>
        </div>

        <div class="info-item">
            <div class="info-label"><i class="bi bi-geo-alt"></i>Alamat</div>
            <p class="info-value">{{ customer.alamat or "Jl. Mawar No. 21, Tegal, Jawa Tengah" }}</p>
        </div>

        <a href="{{ url_for('logout') }}">
            <button class="btn-logout">Keluar</button>
        </a>
    </div>

</div>

<div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content position-relative">

        <button type="button" class="modal-close-btn" data-bs-dismiss="modal">&times;</button>

        <h3 class="profile-title">Pengaturan Profil</h3>

        <form method="POST" enctype="multipart/form-data">

            <div class="text-center">
                <img src="{{ customer.foto_url or 'https://static.promediateknologi.id/crop/0x0:0x0/0x0/webp/photo/p2/222/2024/01/08/11704492-0457-4be8-9256-20411d646e40-1-307500539.jpg' }}" class="profile-img" id="previewFoto">
                <div>
                    <input type="file" class="form-control mt-2" name="foto" accept="image/*" onchange="previewImage(event)">
                </div>
            </div>

            <div class="mt-3">
                <label class="form-label">Nama Lengkap</label>
                <input type="text" class="form-control" name="nama" value="{{ customer.nama }}">
            </div>

            <div class="mt-3">
                <label class="form-label">Email</label>
                <input type="email" class="form-control" name="email" value="{{ customer.email }}">
            </div>

            <div class="mt-3">
                <label class="form-label">No Telepon</label>
                <input type="text" class="form-control" name="telepon" value="{{ customer.telepon }}">
            </div>

            <div class="mt-3">
                <label class="form-label">Alamat</label>
                <textarea class="form-control" name="alamat" rows="3">{{ customer.alamat }}</textarea>
            </div>

            <div class="text-end mt-4">
                <button type="submit" class="btn-save">Simpan Perubahan</button>
            </div>

        </form>

    </div>
  </div>
</div>

<script>
function previewImage(event) {
    const output = document.getElementById('previewFoto');
    output.src = URL.createObjectURL(event.target.files[0]);
}
</script>
{% endblock %}
